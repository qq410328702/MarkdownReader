# Markdown Reader 分发说明

## 已创建的安装包

✅ **便携版安装包已创建成功！**

位置: `MarkdownReader-Portable` 文件夹

## 分发步骤

### 1. 压缩安装包

将 `MarkdownReader-Portable` 文件夹压缩成 ZIP 文件：

```cmd
# 使用 PowerShell 压缩
Compress-Archive -Path MarkdownReader-Portable -DestinationPath MarkdownReader-v1.0.0-Setup.zip
```

或者右键点击文件夹 → 发送到 → 压缩(zipped)文件夹

### 2. 分发给用户

将生成的 ZIP 文件分发给用户，用户只需：

1. 解压 ZIP 文件
2. 右键点击 `install.cmd`
3. 选择"以管理员身份运行"
4. 完成安装

## 安装包内容

```
MarkdownReader-Portable/
├── publish/                    # 应用程序文件（478个文件）
│   ├── MarkdownReader.exe     # 主程序
│   ├── MarkdownReader.dll     # 程序库
│   ├── MarkdownReader.Core.dll
│   └── ... (其他依赖文件)
├── install.cmd                 # 安装脚本
├── README.txt                  # 英文说明
└── 安装说明.txt                # 中文说明
```

## 安装包功能

### 自动文件关联
- `.md` 文件
- `.markdown` 文件
- `.mdown` 文件

### 快捷方式
- 开始菜单快捷方式
- 桌面快捷方式

### 系统集成
- 注册到 Windows 程序列表
- 支持通过控制面板卸载
- 自动创建卸载脚本

## 安装位置

程序将安装到: `C:\Program Files\MarkdownReader`

## 卸载方法

用户可以通过以下方式卸载：

1. Windows 设置 → 应用 → 已安装的应用 → Markdown Reader → 卸载
2. 控制面板 → 程序和功能 → Markdown Reader → 卸载
3. 运行 `C:\Program Files\MarkdownReader\uninstall.cmd`

## 系统要求

- Windows 10 或更高版本
- 管理员权限（仅安装时需要）
- 约 150 MB 磁盘空间

## 注意事项

### 对于分发者

1. 确保 ZIP 文件完整，包含所有 478 个文件
2. 建议在 README 中说明需要管理员权限
3. 可以在 GitHub Releases 或其他平台发布

### 对于用户

1. 必须以管理员身份运行 `install.cmd`
2. 安装过程会修改注册表
3. 首次运行可能需要允许防火墙访问

## 替代方案：创建 MSI 安装包

如果你想创建更专业的 MSI 安装包，需要：

1. 安装 WiX Toolset v3.11+
   - 下载地址: https://wixtoolset.org/releases/

2. 运行构建脚本:
   ```cmd
   .\build-installer.cmd
   ```

3. MSI 文件将生成在 `Setup\bin\MarkdownReaderSetup.msi`

MSI 安装包的优势：
- 更专业的安装界面
- 更好的 Windows 集成
- 支持静默安装
- 更容易的企业部署

## 版本更新

更新版本号时，需要修改：

1. `MarkdownReader\MarkdownReader.csproj`:
   ```xml
   <Version>1.0.1</Version>
   ```

2. `install.cmd` 中的版本信息

3. 重新发布和打包

## 测试清单

在分发前，建议测试：

- [ ] 安装过程正常完成
- [ ] 文件关联正常工作（双击 .md 文件）
- [ ] 快捷方式正常创建
- [ ] 程序正常运行
- [ ] 卸载过程正常完成
- [ ] 卸载后文件关联被清除

## 常见问题

### Q: 用户没有管理员权限怎么办？

A: 可以创建一个绿色版（便携版），不需要安装，直接运行 `MarkdownReader.exe`。但这样无法自动关联文件。

### Q: 如何创建绿色版？

A: 直接将 `MarkdownReader-Portable\publish` 文件夹打包即可，用户解压后运行 `MarkdownReader.exe`。

### Q: 安装失败怎么办？

A: 检查：
1. 是否以管理员身份运行
2. 是否有足够的磁盘空间
3. 是否有杀毒软件阻止
4. Windows 版本是否支持

## 下一步

现在你可以：

1. 压缩 `MarkdownReader-Portable` 文件夹
2. 上传到 GitHub Releases
3. 分享给用户使用

或者：

1. 安装 WiX Toolset
2. 运行 `.\build-installer.cmd`
3. 生成更专业的 MSI 安装包
